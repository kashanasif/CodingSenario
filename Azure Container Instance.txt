{
   "$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
   "contentVersion":"1.0.0.0",
   "parameters":{
      "bindings":[
         {
            "type":"eventGridTrigger",
            "name":"eventGridEvent",
            "direction":"in"
         }
      ],
      "name":{
         "type":"String"
      },
      "location":{
         "type":"String"
      },
      "registryLoginServer":{
         "type":"String"
      },
      "registryUsername":{
         "type":"String"
      },
      "registryPassword":{
         "type":"SecureString"
      },
      "registryImageUri":{
         "type":"String"
      },
      "osType":{
         "defaultValue":"Linux",
         "allowedValues":[
            "Linux",
            "Windows"
         ],
         "type":"String"
      },
      "numberCores":{
         "type":"String"
      },
      "memory":{
         "type":"String"
      },
      "port":{
         "defaultValue":"80",
         "type":"String"
      }
   },
   "variables":{
      "location":"eastus",
      "name":"containerinstance",
      "registryLoginServer":"containerkaashan.azurecr.io",
      "registryUsername":"containerkaashan",
      "registryPassword":"PUj4ZYng9h3S82nzJ+9bjbJnQh76+Uxq",
      "registryImageUri":"containerkaashan.azurecr.io/docker101tutorial:latest",
      "osType":"Windows",
      "numberCores":"2",
      "memory":"2",
      "port":"80"
   },
   "resources":[
      {
         "type":"Microsoft.ContainerInstance/containerGroups",
         "apiVersion":"2017-08-01-preview",
         "name":"[variables('name')]",
         "location":"[variables('location')]",
         "properties":{
            "containers":[
               {
                  "name":"[variables('name')]",
                  "properties":{
                     "image":"[variables('registeryImageUri')]",
                     "ports":[
                        {
                           "port":"[variables('osType')]"
                        }
                     ],
                     "resources":{
                        "requests":{
                           "cpu":"[variables('numberCores')]",
                           "memoryInGb":"[variables('memory')]"
                        }
                     }
                  }
               }
            ],
            "osType":"[variables('name')]",
            "imageRegistryCredentials":[
               {
                  "server":"[variables('registryLoginServer')]",
                  "username":"[variables('registryUsername')]",
                  "password":"[variables('registryPassword')]"
               }
            ],
            "ipAddress":{
               "type":"Public",
               "ports":[
                  {
                     "protocol":"tcp",
                     "value":"80"
                  }
               ]
            }
         }
      }
   ]
}